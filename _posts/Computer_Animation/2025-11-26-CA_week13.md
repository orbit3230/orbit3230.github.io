---
layout: post
title: "[컴퓨터 애니메이션] 13주차 - Facial Animation"
excerpt: "Creatting Facial Expressions, Muscle-based Animation, Realistic Models, The Volume Preservation Forces, Blendshapes, Face Motion Capture, Expression Cloning"

tags:
  - [컴퓨터 애니메이션]

toc: true

date: 2025-11-26
last_modified_at: 2025-12-03
---
## Facial Animation
### 1. Creating Facial Expressions
- 얼굴을 구성하는 점의 개수는 매우 많다.
  - Dimensionality가 매우 높다.

- 따라서 각 Expression(표정)을 manually 만들어내는 것은 매우 tedious하고 time-consuming한 작업이다.

- Fred Parke는 최초로 사람 얼굴에 대한 3D parametric model을 만들었다. (1974)  
![parke_face_model][def]  

<br>

### 2. Muscle-based Animation
- 얼굴 근육을 simulate하기 위해 **mass-and-spring model**을 사용한다.
  - 스프링을 잡아당겼다 놓으면 돌아오려는 힘이 발생하듯이,  
  얼굴 Mesh를 구성하는 vertex와 vertex를 잇는 edge에 스프링을 연결하여,  
  특정 vertex를 움직이면 나머지 vertex들도 자연스럽게 따라 움직이도록 한다.  
  ![mass_spring_face][def2]  

  - 얼굴을 아래와 같이 두 개의 Layer와 세 개의 Surfaces로 모델링될 수 있고, 스프링으로 연결된다.  
  ![point_mass_spring_system][def3]  

- 입 주변은 Elliptical Muscle이라고 하여, 입 주변을 타원형으로 감싸는 근육이 존재한다.  
![elliptical_muscle][def4]  

<br>

### 3. Realistic Models  
- 만약 더 사실적인 사람의 표정을 simulate하고 싶다면, 얼굴의 surface를 스캔할 필요가 있다.

- 우리가 필요로 하는것은, 얼굴의
  - Geometry Data
  - Texture

- Cyberware Color Digitizer
  - 오래된 전통이 있는 스캔 방식
  - A laser range scanner
    - 레이저가 얼굴 표면에 닿고 반사되어 돌아오는 시간을 측정하여,  
    depth map을 생성한다.  
  - 측정된 range data와 실제로 촬영한 color texture를 합치는 방식.  
  ![cyberware_scanner][def5]  

<br>

### 4. The Volume Preservation Forces
- 사람의 피부는 incompressible하다.  
- 주름과 같은 걸을 simulate 하려면, Volume Preservation Force가 필요하다.  
![volume_preservation_force][def6]  

- Volume이 줄어든 양 만큼에 비례하게 노드를 위로 미는 힘을 가한다.  
![pressing_upwards_proportionally][def7]  

<br>

### 4. Blendshapes  
- 실제 영화 산업에서 많이 사용되는 기법.
- **Linear Combination** of Facial expressions
- 미리 수백가지의 Expression vector를 만들어놓고,  
이들에 weight(가중치)를 곱하여 원하는 표정을 만들어낸다.  
![blendshapes][def8]  
  - 얼굴을 구성하는 vertex의 개수가 `m`개이며, expression의 종류가 `n`개라고 하자.  
  - Expression vector가 쌓여서 만들어진 행렬 `B`는 `3m x n`이다.  
    - 각 vertex는 3차원 좌표를 가지므로. (x, y, z)
  - `m`은 일반적으로 10000+α개, `n`은 100+α개 정도이다.  

<br>

- 개념은 간단하지만, 만들어내기는 어렵다. (반지의 제왕은 675개의 blendshape를 사용했다.)
- 숙련된 아티스트가 based mesh를 제작한다.
- 실제 배우나 조각된 모델에서 스캔한다.
- 이미지로부터 3D reconstruction하기도 한다. (여러 각도에서 찍은 사진으로부터 3D 모델을 재구성)

<br>

- 3D 모션 캡쳐 데이터로부터 Blendshape animation 컨트롤을 학습할 수 있다.
  - 아래와 같이 quadratic programming 문제로 표현할 수 있는 constrained linear system을 해결하는 것이다.  
  ![constrained_linear_system][def9]  

  - Least squares를 해결함으로써 weight vector `w`를 역으로 계산하는 것이, 바로 Face Inverse Kinematics(Face IK)이다.  

<br>

### 5. Face Motion Capture
- 광학 트래커 또는 간단히 얼굴의 feature를 추적함으로써 얼굴의 움직임을 캡쳐할 수 있다.  
![face_motion_capture][def10]  

- 그러나 실제 actor와 virtual actor(target)의 geometry는 다를 것이다. 어떻게 virtual actor를 컨트롤할 수 있을까?  
-> Expression Cloning, Deformation Transfer  

<br>

### 6. Expression Cloning
![expression_cloning][def11]  

- Mapping the original face mesh to the target face  
![mapping_original_to_target][def12]  
  - Target face에 대응되는 몇몇 점을 specify. 예를들어,  
    - 코 끝, 눈, 입술 라인, 턱, 등등
  - Specified point들을 기반으로, 이 점들을 가장 잘 표현하는 함수를 찾는다.
  - Radial Basis Function (RBF)를 사용한다.  
  ![rbf_expression_cloning][def13]  
  - 복잡한 함수처럼 보이지만, Gaussian 함수의 선형 결합이다.  
  ![rbf_equation][def14]  
    - input `x`<sub>`i`</sub>는 Source face의 지정된 점들이다.
    - output `f(x`<sub>`i`</sub>`)` = `y`<sub>`i`</sub>는 Target face의 지정된 점들이다.
  - **radial basis function**은 값이 오직 중심점으로부터의 거리(`‖x - b‖`)에만 의존하는 real-valued function이다.  
  ![radial_basis_function_1][def15]  
  ![radial_basis_function_2][def16]  
    - constraints는 사용자가 미리 찾아둔 대응점
    - 변형시킨 후에는 expression vector를 더해준다.

<br>
<br>
<br>
<br>
<details>
<summary>주의사항</summary>
<div markdown="1">

이 포스팅은 강원대학교 김종민 교수님의 컴퓨터 애니메이션 수업을 들으며 내용을 정리 한 것입니다.  
수업 내용에 대한 저작권은 교수님께 있으니,  
다른 곳으로의 무분별한 내용 복사를 자제해 주세요.

</div>
</details> 

[def]: https://i.imgur.com/9yeB9wX.png
[def2]: https://i.imgur.com/jQSmtyy.png
[def3]: https://i.imgur.com/l2pu0ty.png
[def4]: https://i.imgur.com/MMgdkqj.png
[def5]: https://i.imgur.com/JuwifgG.png
[def6]: https://i.imgur.com/QPs4TFw.png
[def7]: https://i.imgur.com/7mvvcvG.png
[def8]: https://i.imgur.com/mRHPESj.png
[def9]: https://i.imgur.com/Qz0Sgsx.png
[def10]: https://i.imgur.com/9vtaHcY.png
[def11]: https://i.imgur.com/MZBPVNI.png
[def12]: https://i.imgur.com/FeBm6hT.png
[def13]: https://i.imgur.com/eXR1kBO.png
[def14]: https://i.imgur.com/26zfqiR.png
[def15]: https://i.imgur.com/Erlxchq.png
[def16]: https://i.imgur.com/Taa9Dei.png