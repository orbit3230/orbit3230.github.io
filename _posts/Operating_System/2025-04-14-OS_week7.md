---
layout: post
title: "[ìš´ì˜ì²´ì œ] 7ì£¼ì°¨ - CPU Scheduling"
excerpt: "CPU Scheduler, Preemptive / Non-Preemptive, Scheduling Algorithms"

tags:
  - [ìš´ì˜ì²´ì œ]

toc: true

date: 2025-04-14
last_modified_at: 2025-04-17
---
## CPU Scheduling
- CPU ë˜í•œ OSì— ì˜í•´ ê´€ë¦¬ë˜ì–´ì•¼ í•˜ëŠ” ì»´í“¨í„° ë¦¬ì†ŒìŠ¤ë“¤ ì¤‘ í•˜ë‚˜ì´ë‹¤.  
- **CPU utilizationì„ ìµœëŒ€í™”**
- CPUê°€ í•­ìƒ ë°”ì˜ê²Œ ì¼í•˜ë„ë¡ ìœ ì§€í•´ì•¼ í•œë‹¤.
- CPU-I/O burst Cycle  
![CPU-I/O burst Cycle][def]  
  - í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ì€ CPU executionê³¼ I/O wait **cycle**ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.
  - CPU burst ë¶„ë°°ê°€ ì£¼ìš” ê´€ì‹¬ì‚¬ê°€ ëœë‹¤.  
- Multiprogrammingì„ ê°€ëŠ¥í•˜ê²Œë” í•œë‹¤.  
- ìš©ì–´ (ëª¨ë‘ ê°™ì€ ì˜ë¯¸)
  - CPU scheduling
  - Process scheduling
  - Kernel thread scheduling

<br>

- CPU-burst íŒ¨í„´ì„ ë¶„ì„í•´ë³´ë©´, ì•„ë˜ì™€ ê°™ì€ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚œë‹¤.  
![CPU-burst][def2]
  - ë§ì€ ìˆ˜ì˜ ì§§ì€ CPU burst
  - ì ì€ ìˆ˜ì˜ ê¸´ CPU burst
  - ì´ ë¶„í¬ëŠ” CPU-schedular ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ë•Œ ì¤‘ìš”í•˜ë‹¤.  

  <br>

### 1. CPU Scheduler
- **CPU schedular**ëŠ” ready queueì— ìˆëŠ” í”„ë¡œì„¸ìŠ¤ ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬, CPU ì½”ì–´ì—ê²Œ í• ë‹¹í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.  
  - QueueëŠ” ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ì •ë ¬ë˜ì–´ ìˆì„ ìˆ˜ ìˆë‹¤.  

- CPU scheduing decisionì€ í¬ê²Œ ë„¤ ê°€ì§€ ìˆœê°„ì— ì´ë£¨ì–´ì§„ë‹¤.  
  - (1) running -> waiting (I/O burst)
  - (2) running -> ready
  - (3) waiting -> ready
  - (4) Terminates

- (1)ê³¼ (4) ìƒí™©ì˜ ê²½ìš°, ë°˜ë“œì‹œ ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ê°€ í• ë‹¹ì´ ë˜ì–´ì•¼ í•œë‹¤. (no choice)
- ê·¸ëŸ¬ë‚˜ (2)ì™€ (3)ì˜ ê²½ìš°, There is a choice.

<br>

### 2. Preemptive / Non-Preemptive
- ìŠ¤ì¼€ì¥´ë§ì´ (1)ë²ˆê³¼ (4)ë²ˆ ìƒí™©ì—ì„œ ì´ë£¨ì–´ì§ˆ ë•Œ, Scheduling schemeì€ **non-preemptive**ì´ë‹¤.

- ê·¸ë ‡ì§€ ì•Šìœ¼ë©´, **preemptive**ì´ë‹¤.  

- Non-preemptive scheduling í•˜ì—ì„œ, ì¼ë‹¨ CPUê°€ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ë˜ì—ˆë‹¤ë©´ í”„ë¡œì„¸ìŠ¤ëŠ” CPUê°€ terminating or waiting ìƒíƒœê°€ ë˜ì–´ ë†“ì•„ì¤„ ë•Œê¹Œì§€ CPUë¥¼ ì ìœ í•œë‹¤.

- ê·¸ë˜ì„œ ê±°ì˜ ëª¨ë“  í˜„ëŒ€ OSë“¤ì€ preemptive schedulingì„ ì‚¬ìš©í•œë‹¤.

<br>

- **Preemptive Schedulingê³¼ Race Conditions**
  - Preemptive Schedulingì€ Race Conditionì„ ìœ ë°œí•  ìˆ˜ ìˆë‹¤.
  - ë‘ í”„ë¡œì„¸ìŠ¤ê°€ ê°™ì€ ë°ì´í„°ë¥¼ ê³µìœ í•˜ê³  ìˆëŠ” ê²½ìš°ë¥¼ ê³ ë ¤í•´ë³´ì.  
  ì¼ë‹¨ í•œ í”„ë¡œì„¸ìŠ¤ê°€ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´, preemptedë˜ë¯€ë¡œ ë‘ ë²ˆì§¸ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‘í•  ìˆ˜ ìˆë‹¤.  
  ë‘ ë²ˆì§¸ í”„ë¡œì„¸ìŠ¤ê°€ ê·¸ ë°ì´í„°ë¥¼ ì½ìœ¼ë ¤ê³  í•˜ë©´, ê·¸ ë°ì´í„°ëŠ” ì¼ê´€ë˜ì§€ ì•Šì€(inconsistent) ìƒíƒœê°€ ëœë‹¤.  
  - ì´ Issueì— ëŒ€í•´ì„œëŠ” Chapter 6ì—ì„œ ìì„¸íˆ ë‹¤ë£¬ë‹¤.  

<br>

### 3. Scheduling Algorithms
- **Dispatcher** ëª¨ë“ˆì€ CPU ìŠ¤ì¼€ì¥´ëŸ¬ì— ì˜í•´ ì„ íƒëœ í”„ë¡œì„¸ìŠ¤ì—ê²Œ CPUì˜ ì œì–´ë¥¼ ë„˜ê²¨ì£¼ëŠ” ì—­í• ì„ í•œë‹¤; this involves  
  - switching context
  - switching to user mode
  - jumping to the proper location  

- **Dispatch latency** : Dispatcherê°€ í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¤‘ì§€í•˜ê³  ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„.  
![Dispatch latency][def3]  

<br>

- **Scheduling Criteria**
  - **CPU utilization** : CPUê°€ ê°€ëŠ¥í•œ ë°”ì˜ê²Œ ì¼í•˜ë„ë¡ í•˜ëŠ” ê²ƒ
  - **Throughput** : unit timeì— executionì„ ì™„ë£Œí•œ í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜
  - **Turnaround time** : íŠ¹ì • í”„ë¡œì„¸ìŠ¤ê°€ execute í•˜ëŠ”ë° ê±¸ë¦° ì´ ì‹œê°„ (CPU ì‚¬ìš©, waiting in I/O, ready queue ëª¨ë‘ í¬í•¨)
  - **Waiting time** : í”„ë¡œì„¸ìŠ¤ê°€ ready queueì—ì„œ ê¸°ë‹¤ë¦° ì´ ì‹œê°„
  - **Response time** : requestê°€ ì œì¶œë˜ê³ , ì²« responseê°€ ëŒì•„ì˜¤ê¸°ê¹Œì§€ ê±¸ë¦° ì‹œê°„.   

<br>

- CPU Scheduling ì•Œê³ ë¦¬ì¦˜
  - "CPU"ë¼ëŠ” ë¶„ì•¼ëŠ” ì •í–ˆì§€ë§Œ, ì–´ëŠ í”„ë¡œì„¸ìŠ¤ê°€ ready queueì— ìˆì„ ì§€, CPU ì½”ì–´ì— í• ë‹¹ë  ì§€ì— ëŒ€í•œ ì§ˆë¬¸ì´ ë‚¨ì•„ìˆë‹¤.  
  -> CPU scheduilngì— ëŒ€í•œ ì•Œê³ ë¦¬ì¦˜ì´ í•„ìš”í•˜ë‹¤.

- **First-Come, First-Serverd (FCFS)**
- **Shortest Job First (SJF)**
- **Priority Scheduling**
- **Round Robin Scheduling (RR)**

- Scheduling ì•Œê³ ë¦¬ì¦˜ì„ ë¹„êµí•˜ê¸° ìœ„í•´, ìš°ë¦¬ëŠ” ì£¼ë¡œ í‰ê·  ëŒ€ê¸° ì‹œê°„ì„ metricìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.  

#### [1] First-Come, First-Served (FCFS)
- CPUì— ë¨¼ì € requestí•œ í”„ë¡œì„¸ìŠ¤ê°€ CPUì— ë¨¼ì € í• ë‹¹ëœë‹¤.
- FCFS ì•Œê³ ë¦¬ì¦˜ì€ FIFO queue structureë¥¼ ì‚¬ìš©í•´ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.  
![FCFS][def4]  
  - í”„ë¡œì„¸ìŠ¤ê°€ ready queueì— ë“¤ì–´ì˜¤ë©´, í”„ë¡œì„¸ìŠ¤ì˜ PCBê°€ FIFO êµ¬ì¡°ì˜ ì‹œì‘ë¶€ë¶„ì— ì‚½ì…ëœë‹¤.
  - CPUê°€ idle ìƒíƒœê°€ ë˜ë©´, FIFO êµ¬ì¡°ì˜ ëì— ìˆëŠ” PCBê°€ CPUì— í• ë‹¹ëœë‹¤.  

- ì„¸ ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ `P1`, `P2`, `P3` ìˆœì„œëŒ€ë¡œ ë„ì°©í–ˆë‹¤ê³  ê°€ì •í•˜ì.  
![FCFS_example][def5]  

- Gantt charëŠ” íŠ¹ì •í•œ ìŠ¤ì¼€ì¥´ë§ì„ í‘œí˜„í•˜ëŠ”, ê° í”„ë¡œì„¸ìŠ¤ì˜ ì‹œì‘ ì‹œê°„ê³¼ ë ì‹œê°„ì„ í¬í•¨í•˜ëŠ” ë°” ì°¨íŠ¸ì´ë‹¤.
- ìœ„ì— ëŒ€í•œ Gantt chartëŠ” ì•„ë˜ì™€ ê°™ë‹¤.  
![FCFS_Gantt][def6]  
- ê° í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ Waiting timeì€, `P1 = 0`, `P2 = 24`, `P3 = 27`  
- **í‰ê·  ëŒ€ê¸° ì‹œê°„** = `(0 + 24 + 27)` / `3` = `17`

<br>

- ê·¸ëŸ°ë° ë§Œì•½ í”„ë¡œì„¸ìŠ¤ë“¤ì´ `P2`, `P3`, `P1` ìˆœì„œë¡œ ë„ì°©í–ˆë‹¤ê³  ê°€ì •í•´ë³´ì.   

- ê·¸ë ‡ë‹¤ë©´ Gantt chartëŠ” ì•„ë˜ì™€ ê°™ë‹¤.  
![FCFS_Gantt2][def7]  

- ê° í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ Waiting timeì€, `P1 = 6`, `P2 = 0`, `P3 = 3`
- **í‰ê·  ëŒ€ê¸° ì‹œê°„** = `(6 + 0 + 3)` / `3` = `3`   
- ì´ì „ ì¼€ì´ìŠ¤ë³´ë‹¤ í›¨ì”¬ ì¢‹ë‹¤.
- **Convoy effect** : ì§§ì€ í”„ë¡œì„¸ìŠ¤ë“¤ì´ ê¸´ í”„ë¡œì„¸ìŠ¤ì— ì˜í•´ ë’¤ì—ì„œ ëŒ€ê¸°í•˜ëŠ” í˜„ìƒ.  

<br>

- FCFS Scheduling ì•Œê³ ë¦¬ì¦˜ì€ **non-preemptive**ì´ë‹¤.  
  - ì¼ë‹¨ CPUê°€ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ë˜ë©´, ê·¸ í”„ë¡œì„¸ìŠ¤ëŠ” CPUë¥¼ ì ìœ í•œë‹¤.
  - Interactive systemì—ì„œëŠ” ë¬¸ì œê°€ ë  ìˆ˜ ìˆë‹¤.  

<br>

- Example  
![FCFS_example2][def8]  

<br>

#### [2] Shortest Job First (SJF)  
- ì´ ì•Œê³ ë¦¬ì¦˜ì€ ê° í”„ë¡œì„¸ìŠ¤ì˜ ë‹¤ìŒ CPU burst timeì˜ ê¸¸ì´ì™€ ê´€ë ¨ì´ ìˆë‹¤.
- CPUì— ë‹¤ìŒ CPU burst timeì´ ê°€ì¥ ì§§ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ í• ë‹¹í•œë‹¤.  
- SJF ì•Œê³ ë¦¬ì¦˜ì€ ì£¼ì–´ì§„ í”„ë¡œì„¸ìŠ¤ ì§‘í•©ì— ëŒ€í•œ minimum average waiting timeì„ ë³´ì¥í•œë‹¤.  

<br>

- ë‹¤ìŒê³¼ ê°™ì€ CPU burstë¥¼ ê°€ì§„ í”„ë¡œì„¸ìŠ¤ ì§‘í•©ì„ ê°€ì •í•´ë³´ì.  
![SJF_example][def9]  

- ìœ„ ì˜ í”„ë¡œì„¸ìŠ¤ ì§‘í•©ì— ëŒ€í•´, SJF ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ Gantt chartê°€ ë‚˜ì˜¨ë‹¤.  
![SJF_Gantt][def10]  

- **í‰ê·  ëŒ€ê¸° ì‹œê°„** = `(0 + 3 + 9 + 16)` / `4` = `7`  
  - ì°¸ê³ ë¡œ FCFS ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œëŠ” `10.25`ms !  

<br>

- Non-preemptive vs. Preemptive
  - Non-preemptive SJF - ë§Œì•½ CPUê°€ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ë˜ë©´, ì˜¤ì§ í”„ë¡œì„¸ìŠ¤ê°€ CPU burstë¥¼ ì™„ë£Œí•  ë•Œê¹Œì§€ CPUë¥¼ ì ìœ í•œë‹¤.
  - Preemptive SJF - ë§Œì•½ ë„ì°©í•œ í”„ë¡œì„¸ìŠ¤ê°€ shortest-next-CPU burstë¼ë©´, í˜„ì¬ CPUë¥¼ ì‚¬ìš©í•˜ë˜ í”„ë¡œì„¸ìŠ¤ëŠ” CPU ì ìœ ë¥¼ ë†“ì•„ì£¼ê³  ë„ì°©í•œ í”„ë¡œì„¸ìŠ¤ê°€ CPUë¥¼ ì ìœ í•œë‹¤.  
  -> a.k.a, **Shortest Remaining Time First (SRTF)**  

<br>

- non-preemptive SJF ìŠ¤ì¼€ì¥´ë§ì˜ Example  
![SJF_example2][def11]  
  - Burst timeì´ ê°™ë‹¤ë©´, Arrival timeì´ ë¹ ë¥¸ ê²ƒì„ ìš°ì„ 

- Gantt chartëŠ” ì•„ë˜ì™€ ê°™ë‹¤.  
![SJF_Gantt2][def12]  

- **í‰ê·  ëŒ€ê¸° ì‹œê°„** = `(0 + 6 + 3 + 7)` / `4` = `4`  

<br>

- Preemptive SJF ìŠ¤ì¼€ì¥´ë§ì˜ Example  
![SJF_example3][def13]  

- Gantt chartëŠ” ì•„ë˜ì™€ ê°™ë‹¤.  
![SJF_Gantt3][def14]  

- **í‰ê·  ëŒ€ê¸° ì‹œê°„** = `(9 + 1 + 0 + 2)` / `4` = `3`  

<br>

- Example of Preemptive SJF  
![SJF_example4][def15]  

- Example of Non-preemptive SJF  
![SJF_example5][def16]  

<br>

- SJF Schedulingì˜ ë‹¨ì  - next CPU burstê°€ ì–¼ë§ˆì¸ ì§€ ì–´ë–»ê²Œ ì•„ëŠ”ê°€ ?!  
-> ë‹¤ìŒ CPU burstë¥¼ ì•Œ ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ì—†ë‹¤. í•˜ì§€ë§Œ..

- lengthë¥¼ ì¶”ì •í•˜ëŠ” ê²ƒì´ë‹¤. ì¦‰, ì´ì „ ê²ƒê³¼ ë¹„ìŠ·í•  ê²ƒì´ë¼ê³  ê°€ì •í•˜ëŠ” ê²ƒì´ë‹¤.  
  - ê·¸ë¦¬ê³ ëŠ” ê°€ì¥ CPU burstê°€ ì§§ì„ ê²ƒì´ë¼ ì˜ˆì¸¡í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ ê³ ë¥¸ë‹¤.

- ì§€ìˆ˜ í‰ê· ì„ ì‚¬ìš©í•´, ì´ì „ CPU burstsì˜ ê¸¸ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì´ë£¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤.  
  - (1) `t`<sub>`n`</sub> = `n`thì˜ ì‹¤ì œ CPU burst time
  - (2) `ğœ`<sub>`n+1`</sub> = `n+1`thì˜ ì˜ˆì¸¡í•œ CPU burst time
  - (3) `ğ›¼`, `0 <= ğ›¼ <= 1`
  - (4) Define:

- ì¼ë°˜ì ìœ¼ë¡œ, `ğ›¼` set `ğœ`<sub>`n+1`</sub> = `ğ›¼t`<sub>`n`</sub>+`(1 - ğ›¼)ğœ`<sub>`n`</sub>

- ë‹¤ìŒ CPU burstì˜ ê¸¸ì´ ì˜ˆì¸¡ Example  
![SJF_example6][def17]  

<br>

- SJF ì•Œê³ ë¦¬ì¦˜ì˜ ì‹¤ì œ ì‚¬ìš© ì˜ˆ  
  - "Information-Agnostic Flow Scheduling for Commodity Data Centers", Wei Bai, et al., USENIX NSDI, 2015  
  ![SJF_example7][def18]  
  ![SJF_example8][def19]

  - "DRAM Scheduling Policy for GPGPU Architectures Based on a Potential Functionâ€, Nagesh, et al., IEEE CAL, 2012  
  ![SJF_example9][def20]  
  ![SJF_example10][def21]  

<br>
<br>
<br>
<br>
<details>
<summary>ì£¼ì˜ì‚¬í•­</summary>
<div markdown="1">  

ì´ í¬ìŠ¤íŒ…ì€ ê°•ì›ëŒ€í•™êµ ì†¡ì›ì¤€ êµìˆ˜ë‹˜ì˜ ìš´ì˜ì²´ì œ ìˆ˜ì—…ì„ ë“¤ìœ¼ë©° ë‚´ìš©ì„ ì •ë¦¬ í•œ ê²ƒì…ë‹ˆë‹¤.  
ìˆ˜ì—… ë‚´ìš©ì— ëŒ€í•œ ì €ì‘ê¶Œì€ êµìˆ˜ë‹˜ê»˜ ìˆìœ¼ë‹ˆ,  
ë‹¤ë¥¸ ê³³ìœ¼ë¡œì˜ ë¬´ë¶„ë³„í•œ ë‚´ìš© ë³µì‚¬ë¥¼ ìì œí•´ ì£¼ì„¸ìš”.  

</div>
</details>

[def]: https://i.imgur.com/0mW82jZ.png
[def2]: https://i.imgur.com/F4Jvquc.png
[def3]: https://i.imgur.com/1rddWL9.png
[def4]: https://i.imgur.com/6gqa7gz.png
[def5]: https://i.imgur.com/rHzeWTO.png
[def6]: https://i.imgur.com/V5bKxVL.png
[def7]: https://i.imgur.com/r20nfYp.png
[def8]: https://i.imgur.com/4PuAZxJ.png
[def9]: https://i.imgur.com/DeVzZOF.png
[def10]: https://i.imgur.com/GbnmRhb.png
[def11]: https://i.imgur.com/RZR1JEN.png
[def12]: https://i.imgur.com/4iqnLfv.png
[def13]: https://i.imgur.com/N3G5DDh.png
[def14]: https://i.imgur.com/PKoxhLl.png
[def15]: https://i.imgur.com/NXp3zSL.png
[def16]: https://i.imgur.com/raTnO6t.png
[def17]: https://i.imgur.com/u47CeYi.png
[def18]: https://i.imgur.com/ABdsb17.png
[def19]: https://i.imgur.com/aMpUt1C.png
[def20]: https://i.imgur.com/jTyQJWq.png
[def21]: https://i.imgur.com/A1RsMH1.png