---
layout: post
title: "[데이터 분석 프로그래밍] 9주차 - Data Preprocessing"
excerpt: ""

tags:
  - [데이터 분석 프로그래밍, Python]

toc: true

date: 2024-10-29
last_modified_at: 2024-10-29
---
## Data Preprocessing
- 데이터 분석 수행 이전에 데이터를 정제하고 준비하는 과정  
  - 실제 세계 데이터는 일반적으로 "dirty data"이며, data 퀄리티 문제가 존재한다.  
  - 실제 세계 데이터는 종종 불완전하고, noise가 섞여 있으며, 모순이 있을 수 있다.  

- Data preprocessing은 이러한 문제를 해결하고 데이터를 분석에 적합한 형태로 바꾸는 데에 초점을 둔다.  

- 실제 세계 데이터의 특징
  - (1) Incomplete
    - Missing Values
    - Gaps in Time Series Data
    - Inconsistencies in Merged Datasets

  - (2) Noisy
    - Sensor Errors
    - Typos and Input Errors
    - Background Noise

  - (3) Inconsistent
    - 더로 다른 소스 간 측정 단위의 Inconsistencies
    - 데이터의 형식 간 Inconsistencies

### 1. Data Cleaning
- Main task
  - missing values(`NaN`) 처리
  - 중복 데이터 제거
  - 데이터 형식 일관성 유지
  - 이상치 파악 및 처리
  - 오타 수정 및 부적절한 값 정상화  
  
  <br>

- `df.info()` : DataFrame의 정보를 출력  
![df_info](TODO)  
  - `Dtype`은 각 열에 저장된 데이터의 타입을 나타낸다.  
    - `object` : 문자열
    - `int64`, `int32`, `int16` : 정수형
    - `float64`, `float32` : 실수형
    - `bool` : Boolean
    - `datetime64` : 날짜 및 시간  

<br>

- `df.describe()` : DataFrame의 numeric columns 에 대한 통계 정보를 출력  
![df_describe](TODO)  
  - `df.describe(include='object')` : 문자열 데이터에 대한 통계 정보 출력  
  ![df_describe_object](TODO)  

  <br>

#### [1] Missing Value  
- 데이터 분석에서, Missing Value는 하나 이상의 필드가 비어있는 instance를 의미한다.  

- Missing value는 데이터 분석, 통계적 모델링, 머신 러닝 알고리즘의 성능에 부정적인 영향을 미칠 수 있다.  

<br>

- **Drop Missing Values**
  - `df.dropna()` : NaN이 포함된 행을 삭제
  - `df.dropna(axis=1)` : NaN이 포함된 열을 삭제 (caution)  
  ![dropna](TODO)  

<br>

- **Handling Missing Values with Imputation** - missing values를 채우는 것
  - 가장 간단한 방법은 non-missing values 들의 mean/median/mode 값으로 채우는 것이다.  
    - `df.fillna(df.mean())` : `NaN`을 해당 열의 평균값으로 채움  
    - `SimpleInputer()` : scikit-learn에서 제공하는 missing value filling methods  
    `SimpleImputer(strategy='mean')` : `NaN`을 해당 열의 평균값으로 채움  

  - k-NN Imputation
    - k-NN 알고리즘을 사용하여 missing value를 채우는 방법  
    - `KNNImputer()` : scikit-learn에서 제공하는 k-NN Imputation method  
    `KNNImputer(n, neighbors=k)` : `NaN`을 해당 열의 k개의 가장 가까운 이웃의 평균값으로 채움

<br>

#### [2] Data Filtering
- 데이터 필터링은 데이터셋에서 매우 관련성 있거나 특정 criteria를 만족하는 데이터만 selecting하는 절차이다.  

- 불필요하거나 noisy한 정보를 제거함으로서,  
데이터의 퀄리티와 분석의 정확도를 향샹시킨다.  

<br>

- **Column Filtering**
  - `df.filter(['column_name1', 'column_name2'])` : 특정 열들만 선택  

  - 만약 하나의 column이 specify 되면, table 보다는 list로서 column을 specify 하는 편이 낫다.  
    - `df[['column_name']]` : `column_name`열만 가지는 **DataFrame**
    - `df['column_name']` : `column_name`열만 가지는 **Series** <- better  

    <br>

- **Row Filtering**
  - `df.filter([0, 1, 2], axis=0)` : 특정 행들만 선택

  - `df[2:5]` : slicing으로 행 section 선택  

  - `df[df.Team=='Liverpool']` : 특정 조건을 만족하는 행만 선택  

    - `df[df.Team.isin(['Liverpool', 'Arsenal'])]` : 특정 조건들 중 하나 이상을 만족하는 행만 선택(`or` 조건)  

    - `df[(df.Team=='Liverpool') & (df.Position=='DF')]` : 특정 조건들을 모두 만족하는 행만 선택(`and` 조건)  

<br>

#### [3] Outliers
- Outlier는 비슷한 points들의 majority와 크게 떨어진 data point를 의미한다.  
![outlier](TODO)  

- Interquartile Range (IQR)
  - IQR은 데이터의 중간 50%를 나타내는 값이다. (Q3 - Q1)  
    - Q1 : 1사분위수, 25% 지점
    - Q3 : 3사분위수, 75% 지점  

- Outlier Detection
  - `Q1 - 1.5 * IQR` 보다 작거나,  
  `Q3 + 1.5 * IQR` 보다 큰 값은 outlier로 간주한다.  

```py
attribute = 'Salary'
Q1 = df[attribute].quantile(0.25)
Q3 = df[attribute].quantile(0.75)
IQR = Q3 - Q1
outlier_step = 1.5 * IQR
df_outliers = df[(df[attribute] < Q1 - outlier_step) | (df[attribute] > Q3 + outlier_step)]
```

<br>
<br>
<br>
<br>
<details>
<summary>주의사항</summary>
<div markdown="1">

이 포스팅은 강원대학교 장홍준 교수님의 데이터분석프로그래밍 수업을 들으며 내용을 정리 한 것입니다.  
수업 내용에 대한 저작권은 교수님께 있으니,  
다른 곳으로의 무분별한 내용 복사를 자제해 주세요.

</div>
</details> 