---
layout: post
title: "[마이크로프로세서] 4주차 - 기계어와 실행"
excerpt: ""

tags:
  - [마이크로프로세서]

toc: true

date: 2024-09-26
last_modified_at: 2024-09-26
---
## TOY 프로세서의 기계어와 실행
### 1. 직접 어드레싱의 기계어 표현

```s
        .ORIGIN 3000
        COPY R0, 0
        LOAD R1, value
        ASR R2, R1, 3
        STORE R2, quot
        ...
value: .FILL 0x123
quot: .BLOCK 1
```

- 직접 어드레싱 메모리 주소 = PC + offset  
![direct_addressing_machine_level](TODO)  

<br>

- LOAD / STORE / LEA / BR 에서 주소 결정  
  - 기계어 코드에서는 16비트 정수인 offset으로 표현
  - 목적지 주소가 `addr`이면, `offset` = `addr - PC`
  - TOY 프로세서의 실행과정에서 주소 결정
![addr_determine](TODO)  

- LOAD 명령어의 실행  
![load_detemine](TODO)  

- STORE 명령어의 실행  
![store_detemine](TODO)  

- LEA 명령어의 실행  
![lea_detemine](TODO)  

- BR 명령어의 실행  
![br_detemine](TODO)  

<br>

+) `LOAD`와 `LDR`의 비교
  - `LOAD Rd, addr` : addr = PC + offset <- 현재 실행위치 기준
  - `LDR Rd, Ra, offset` : addr = Ra + offset <- 지정된 레지스터 기준  

  <br>

### 2. TOY 프로세서 기계어 코드
- TOY 프로세서 기계어 코드 표  
![toy_processor_machine_code_table](TODO)  

<br>

- TOY 기계어 32비트의 구성  
![toy_machine_language_32_bits](TODO)

- OP : 명령어 그룹 구분  
(`000`: 산술논리연산, `001` : 메모리 읽기, `010` : 메모리 쓰기, ...)
- ALU : 명령어 그룹 내에서 명령어 구분
- DR : 목적지 레지스터 지정 (`STORE`/`SRR`은 소스 레지스터)
- CC : 연산 결과를 DR에 기록하는 조건 (nzp 대응)
- SR : 연산의 소스 레지스터 or 주소 레지스터
- V : SR2/VAL 부분의 구별 표시
  - `0` : SR2 가 두번째 소스 레지스터 (VAL을 무시)
  - `1` : SR2/VAL을 합친 16비트가 정수로서 2번째 소스 오퍼랜드

<br>

### 3. 산술 연산 명령어의 기계어 표현
- `ADD`/`SUB`/`AND`/`OR`/`XOR` 명령어의 기계어 표현  
![add_sub_and_or_xor](TODO)

  - `ADD` 명령어 예시  
  ![add_example](TODO)

  - `SUB` 명령어 예시  
  ![sub_example](TODO)

  - `AND` 명령어 예시  
  ![and_example](TODO)

  - `OR` 명령어 예시  
  ![or_example](TODO)

  - `XOR` 명령어 예시  
  ![xor_example](TODO)

<br>

- `CMP`와 `SUB`의 기계어 비교  
![cmp_vs_sub](TODO)  
  - CC 필드와 DR 필드에 차이점이 존재한다.  

<br>

- `NOT` 명령어의 기계어 표현  
![not](TODO)  
  - 마지막 두 명령어, `NOT R2, R0`와 `XOR R2, R0, -1`은 기계어 코드가 같다.  
  - 이는, 실제로 `-1`과의 Exclusive OR 연산과 Not 연산은 같은 기능을 하기 때문이다.  
  따라서 별도의 `NOT` 명령어의 기계어 표현은 없다고 봐도 무방하다.  

<br>

- `COPY` 명령어의 기계어 표현  
![copy](TODO)  

<br>

- `LSL`/`LSR` 명령어의 기계적 표현  
![lsl_lsr](TODO)

- `ASL`/`ASR` 명령어의 기계적 표현  
![asl_asr](TODO)  

<br>

### 4. 메모리 읽기 명령어의 기계어 표현  
- `LOAD` 명령어의 기계어 표현  
![load](TODO)  

- `LDR`/`LOAD` 명령어의 기계어 표현  
![ldr_vs_load](TODO)  

<br>

### 5. 메모리 쓰기 명령어의 기계어 표현
- `STR`/`STORE` 명령어의 기계어 표현  
![str_vs_store](TODO)  

<br>
<br>
<br>
<br>
<details>
<summary>주의사항</summary>
<div markdown="1">  

이 포스팅은 강원대학교 김용석 교수님의 마이크로프로세서 수업을 들으며 내용을 정리 한 것입니다.  
수업 내용에 대한 저작권은 교수님께 있으니,  
다른 곳으로의 무분별한 내용 복사를 자제해 주세요.  

</div>
</details>

[def]: https://i.imgur.com/wzHgvt6.png