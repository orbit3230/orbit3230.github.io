---
layout: post
title: "[리눅스 프로그래밍] 13주차 - File & Directories"
excerpt: ""

tags:
  - [리눅스 프로그래밍]

toc: true

date: 2024-05-27
last_modified_at: 2024-05-27
---
## Binary analysis
- GDB
  - `ni` -> next (assembly-level)
  - `disas` -> dis-assembly
  - `disas /m` -> ?

- Objective Code(16진수)를 저장하고 싶다면,,
TODO

<br>

## File
### 1. File and Inode
- 우리가 단순 `Hello, world` 텍스트만 내용으로 가진 아무 파일이나 만들었다면,  
도대체 이 파일에 대한 Access Mode, File Size, Accessed Time 등의 Meta data들은 어디에 저장되는걸까?  

  - `Inode` 라는 이름의 object에 저장된다.  

  <br>

### 2. `stat()`
- `stat()` : get file status  
`int stat(const char *pathname, struct stat *statbuf)`

  - `pathname`을 제공하면, `stat()` 함수는 해당 이름의 파일에 대한 정보의 structure를 반환해준다.  

  - `int fstat(int fd, struct stat *statbuf)`
  TODO

  - `int lstat(const char *pathname, struct stat *statbuf)`
    - `lstat()`은 `stat()`과 거의 똑같지만 
    만약 주어진 `pathname`이 symbolic link 라면,  
    그것이 가리키는 파일이 아니라, link 그 자체에 대한 information을 반환한다.  

  <br>

- `struct stat`은, 
  - `st_atime` : time of last access
  - `st_mtime` : time of last modification
  - `st_ctime` : time of last status change  
  (content modification (X) / Inode (O))
  - `st_blksize` : optimal block size for I/O
  - `st_blocks` : the # of blocks  
  ...
    - 등의 다양한 meta data들로 구성된 structure이다.  
    - `struct stat`은 Linux distribution에 따라 다르게 정의되어있다.  
    (Ubuntu, Fedora, Debian, ... etc)  
    - `include <sys/stat.h>`  

    <br>

### 3. Link
- 우리가 `ls -alstr` 명령어를 사용하면 directory entry들이 모두 나열되고,  
이 entry들은 name과 inode를 가진다.  

- Link
  - Symbolic Link
    - TODO

  - Hard Link
    - TODO

<br>

### 4. File Type
- Regular file
  - 가장 흔히 보이는 파일 타입. 어떠한 형태의 데이터를 담고있다.  
  - Linux kernel은 이 데이터가 text인지, binary인지 전혀 관심이 없다.  

- Directory file

- Block special file

- Character special file

- FIFO
  - `p---------`

- Socket
  - `s---------`

- Symbolic link
  - `l---------`

<br>

- 이러한 file의 type은 `stat` structure의 `st_mode` 멤버에 encode 된다.  

![st_mode](TODO)

  - File type
    - 아래와 같은 매크로로 file type을 구별할 수 있다.  

    |Macro|Type of file|
    |---|---|
    |TODO|TODO|

    <br>

  - Special
    - [아래에서 다루자.](TODO)

  - Permission
    - TODO
    <br>
    - File access permission modifying

    - Permission for a file
      - Read permission for a file
      - Write permission for a file
      - Permission for a directory  

      <br>

### 5. ★ Effective User ID
- TODO

- Real user and group ID
  - 실제로 who we are.
  - log-in 한 User.

- Effective user and group ID
  - TODO  

  <br>

### 6. `unlink()`
- TODO

<br>

### 7. `access()`
- TODO  

<br>

### 8. `chown()`
- 파일의 owvership을 바꾼다.  
`int chown(const char *pathname, mode_t mode)`
`int fchown(int fd, uid_t owner, gid_t group)`
`int lchown(const char *pathname, uid_t owner, gid_t group)`

### 9. `chmod()`, `fchmod()`