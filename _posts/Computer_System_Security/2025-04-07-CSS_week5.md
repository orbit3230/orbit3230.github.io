---
layout: post
title: "[컴퓨터시스템보안] 5주차 - 데이터베이스와 클라우드 보안"
excerpt: "데이터베이스, 관계형 데이터베이스, SQL Injection, 데이터베이스 접근 제어, 추론, 데이터베이스 암호화, 클라우드 컴퓨팅"

tags:
  - [컴퓨터시스템보안]

toc: true

date: 2025-04-07
last_modified_at: 2025-04-10
---
## 데이터베이스  
### 1. 데이터베이스
![database][def]  
- **하나 이상의 애플리케이션**에서 사용할 목적으로 구조화되어 저장된 데이터의 집합

- **데이터** 뿐만 아니라 데이터 항목들 간의 **관계**나 **그룹**도 보관한다.

- 종종 안전하게 보호해야 할 **민감한 데이터**를 담고 있을 수도 있다.  

- **데이터베이스 관리 시스템**(DBMS)
  - 데이터베이스를 구축하고 유지하는 **프로그램의 모음**
  - 다수의 사용자들과 애플리케이션들에게 **쿼리**(query) 기능을 제공

- **쿼리 언어**(Query Language) : **데이터베이스 인터페이스**를 제공  

<br>

### 2. 관계형 데이터베이스  
![relational_database][def2]  
- 행과 열로 구성된 데이터의 **테이블**  
![relational_database2][def3]  
  - 각 **열**은 특정 타입의 데이터 (**속성**)
  - 각 **행**은 각 열의 특정 값 (**튜플**, **레코드**)
  - 최소 하나의 열이 존재하며, 이 열은 각 행을 고유하게 식별하는 **기본 키**(Primary Key)로 사용됨

- 모든 테이블에 존재하는 고유 식별자에 의해 다수의 테이블을 연결할 수 있음  
![relational_database3][def4]  
  

- 데이터베이스 액세스에는 관계형 **쿼리 언어**(SQL)를 사용  
  - 사용자는 주어진 조건(criteria)에 맞는 데이터를 요청할 수 있음  
  - 관계형 데이터베이스에서 스키마 정의, 데이터 처리, 데이터 쿼리에 사용하는 표준 언어  

  <br>

### 3. SQL Injection  
![sql_injection][def5]  
- 가장 널리 사용되고 위험한 네트워크 기반 보안 위협

- **쿼리를 동적으로 만들어 후위의 DB에 전달**

- 가장 흔한 목적은 **다량의 데이터 추출**

- **다음과 같은 상황에 사용**
  - 데이터 변경 혹은 삭제 (무결성 침해)
  - 임의의 OS 명령 실행   
  - DoS(denial of Service) 공격 (가용성 침해)

<br>

- **주요 발생 원인**
  - 사용자 입력이 SQL 문장의 문자열 이스케이프 문자들로 부정확하게 필터
  - 사용자 입력이 강한 데이터 타입으로 표현되지 못해 우발적으로 실행  

<br>

- **주요 공격 방법**
  - 사용자 입력 : 공격자가 적절하게 조합된 **사용자 입력을 제공하여 SQL 명령어**를 주입
  - 서버 변수 : HTTP 헤더, 네트워크 프로토콜 헤더, 환경 변수 값을 위조하여 원하는 값을 직접 헤더에 삽입
  - 2차 주입 : **시스템이나 데이터베이스에 존재하는 데이터**를 이용하여 SQL 명령어를 주입
  - 쿠키 : **쿠키의 내용에 기반하여 SQL 명령어**를 주입
  - 물리적 사용자 입력 : 웹 요청 범위 밖에서 공격을 만드는 사용자 입력을 통해 SQL 명령어를 주입 (**바코드**, **QR 코드** , **RFID 태그** 등)  

  <br>

- **SQL injection 공격 유형**
  - (1) **대역 내 공격** (Inband Attacks) : SQL 코드 주입과 결과 반환에 **같은 통신 채널** 사용
    - 동의어 반복 : 조건문에 코드를 주입하여 **항상 참으로 계산**되도록 유도  
      - e.g., 공격자가 이름 필드에 `' OR 1=1 --`를 입력  
      `SELECT * FROM users WHERE name = ' ' OR 1=1 --' AND pwd = ' '`
    - 라인 주석 : 코드를 주입할 때 뒤따르는 정상 코드들을 **라인 주석(`--`)**으로 무효화  
    - 피기백(piggyback) 쿼리 : 정상 쿼리 위에 추가 공격 쿼리 편승  

  - (2) **추론적 공격** (Inferential Attack) : 실제 데이터 전송 없이, 특정 요청을 보내 결과 행동을 관찰함으로써 **정보를 재구성**
    - 불법적/논리적으로 틀린 쿼리 : **정보 수집의 예비 단계**로서, **데이터베이스의 유형과 구조**에 대한 중요한 정보를 수집
    - 블라인드 SQL 주입 : 서버에 **참/거짓 질문**을 통해 데이터베이스에 존재하는 **실제 정보를 추론**

  - (3) **대역 외 공격** (Out-of-Band Attack) : 결과 데이터를 **다른 채널로  반환**. 쿼리 결과 **이메일**이 생성되어 전달
    - 정보 추출에는 제한이 있지만, 데이터베이스 서버로부터 **외부 연결이 느슨**할 때 사용 가능.  

    <br>

- **SQL injection 대응책**(Countermeasures)
  - (1) **방어적(defensive) 코딩** : 불안전한 코딩 습관 방지
    - 수동 방어적 코딩 습관 : **불충분한 입력 값 검증** 방지를 위해, 비정상적인 입력을 구별하는 패턴 매칭 사용
    - 매개변수 쿼리 삽입 : 보다 정확히 SQL 쿼리 구조를 정의하기 위해, **쿼리를 구성하는 문자열 값을 독립적인 매개변수**로 전달
    - SQL DOM : **SQL DOM**은 자동으로 **데이터 타입의 유효성과 이스케이핑을 검증**. DB 쿼리를 캡슐화하여 안전하고 신뢰성 ↑

  - (2) **탐지(detection)**
    - **시그니처 기반**(signature based) : **특정 공격 패턴과 유사**한 지 매치하여 탐지
    - **변칙 기반**(anomaly based) : **정상 행위를 정의**, 정상 행위 밖의 행위 패턴을 탐지
    - **코드 분석** : 취약성 탐지를 위해 **테스트 도구 모음**을 사용.

  - (3) **실행시간 방지**(run-time prevention)
    - 제시된 쿼리가 예상 쿼리 모델을 준수하는 지 런타임에 확인  

    <br>

### 4. 데이터베이스 접근 제어
- **데이터베이스 접근 제어** : 사용자가 데이터베이스에 액세스할 때, 사용자가 어던 접근 권한을 가지는 지 판별 

- 다양한 관리 정책
  - **중앙(centralized) 관리** : 소수 사용자(관리자)들 만이 접근 권한을 부여/회수
  - **소유권 기반(ownership-based) 관리** : 테이블 소유자가 테이블에 대한 접근 권한을 부여/회수
  - **분산적(decentralized) 관리** : 테이블 소유자가 테이블에 대한 접근 권한을 부여/회수할 수 있는 권한을 다른 사용자에게 부여  

  <br>

- **SQL 접근 제어**
  - 접근 권한 관리를 위한 두 가지 명령  
    - `GRANT` : 권한/역할 부여
    - `REVOKE` : 권한/역할 회수  
    - 사용 예  
    ![sql_access_control][def6]  

  - 접근 권한 유형
    - `SELECT` : 테이블에서 데이터 읽기
    - `INSERT` : 테이블에 데이터 삽입
    - `UPDATE` : 테이블의 데이터 수정
    - `DELETE` : 테이블의 데이터 삭제
    - `REFERENCES` : 테이블의 외래 키를 참조하는 권한 부여  

    <br>

- **계단식(연쇄) 권한 부여** (Cascading Authorizations)  
![cascading_authorizations][def7]  
  - 사용자 `A`가 접근 권한을 취소하면 `A`로부터의 해당 시점 모든 연쇄적인 접근 권한들을 회수  
  - 회수에서 제외되는 접근 권한은 `A`가 부여하지 않았더라도 존재할 수 있는 접근 권한  

  <br>

- **역할 기반 접근 제어** (RBAC)
  - **RBAC**는 **DB 접근 제어**에 자연스럽게 잘 어울림.
  - 데이터베이스 사용자 카테고리
    - **애플리케이션 소유자**(application owner)
    - **최종 사용자**(end user)
    - **관리자**(administrator)  
  - 데이터베이스 RBAC는 다음 기능을 제공
    - 역할의 생성/삭제
    - 각 역할의 접근 권한 정의
    - 사용자-역할의 지정/회수  

    <br>

### 5. 추론(Inference)
![inference][def8]  
- **추론** : 사용자의 정당한 쿼리와 응답으로부터 **비인가된 정보를 추론**  

- **추론 채널** : 비인가된 데이터를 획득하는 정보 전송 경로  

- **추론 탐지**
  - 데이터베이스 설계 시 추론 탐지
    - 데이터베이스 구조나 접근 제어 방식을 변경하여 **추론 채널**을 제거
    - 테이블을 **여러 테이블로 분리**하여 의존성 제거, RBAC 방식에서 더 세밀한 접근 제어 역할 부여

  - 쿼리 처리 시간에 추론 탐지  
    - 쿼리 처리 중에 추론 채널 위반을 제거
    - 추론 채널이 탐지되면 쿼리를 변경하거나 거부  

<br>

### 6. 데이터베이스 암호화
- 데이터베이스는 주로 조직의 가장 중요한 정보를 저장
  - 다양한 보안 layers에 의해 보호되고 있음
    - 방화벽, 인증 메커니즘, 접근 제어 시스템, DB 접근 제어 시스템, **데이터베이스 암호화** 등

  - DB 내 특히 민감한 데이터는 **암호화**하여 보호
    - 레코드 레벨, 속성 레벨, or 개별 필드 레벨에서 전체 DB에 암호화를 적용할 수 있음

- 암호화의 단점
  - **키 관리** : DB의 수 많은 이용자/애플리케이션에 안전하게 키를 배포하는 것이 어려움
  - **비유연성**(inflexibility) : DB가 암호화된 경우, 레코드 검색이 어려워짐  

  <br>

- **데이터베이스 암호화 기법**  
![database_encryption](TODO)  
  - **데이터 소유자** : 사용자에게 데이터를 제공하는 조직
  - **사용자** : 시스템에게 정보 요청을 하는 존재
  - **고객**(client) : 사용자 요청을 저장된 **암호 데이터에 대한 요청으로 변환**시키는 front-end
  - **서버** : 데이터 소유자로부터 암호화된 데이터를 받아 고객에게 제공하는 조직  
![database_encryption2](TODO)  
![database_encryption3](TODO)  

<br>

### 7. 클라우드 컴퓨팅
- NIST SP-800-145 정의
  - **클라우드 컴퓨팅** : **공유된 컴퓨팅 리소스**에 대해 **언제/어디서나**, **필요할 때 접근을 가능**하게 해주는, **고가용성**의 **온디맨드**(on-demand) 서비스 모델  

- Cloud Computing Elements  
![cloud_computing_elements](TODO)  

- **NIST 세 가지 서비스 모델**  
![cloud_computing_service_model](TODO)  
  - **SaaS**(Software as a Service) : 소프트웨어를 서비스로 제공 (e.g., Gmail)  
  - **PaaS**(Platform as a Service) : 플랫폼을 서비스로 제공 (e.g., Google App Engine)  
  - **IaaS**(Infrastructure as a Service) : 인프라를 서비스로 제공 (e.g., Amazon EC2)  

<br>

- **클라우드 보안 위험**  
  - **클라우드 컴퓨팅의 남용과 오용**
    - 사용자가 쉽게 클라우드 서비스에 등록, 사용할 수 있음
    - 공격자들 또한 쉽게 들어와 공격을 시도할 수 있음
    - 대응 방법 : 보다 엄격한 초기 등록, 트래픽 감시, 공개 블랙리스트 감시

  - **비보안 인터페이스와 API**
    - 제공자는 서비스 관리/이용을 위한 API 공개
    - API는 보안 정책을 위반하는 시도를 방지하도록 설계
    - 대응 방법 : 제공자 API의 보안 모델 분석, 암호화 전송에 적합한 강력한 인증과 접근 제어 구현, API 의존 관게 이해

  - **악의적 내부자**
    - 소비자는 제공자의 보안 제어의 의존. 따라서 내부 공격자의 위험이 존재
    - 대응 방법 : 공급망 관리와 공급자 평가, 계약 시 보안 요구사항 명시, 정보 보안과 관리에 투명성 요구, 보안 감사와 모니터링

  - **공유 기술 이슈**
    - CPU, 캐시, GPU 등이 사용자들 간 철저한 격리 없이 설계된 경우
    - 대응 방법 : 설치/구성에 대한 보안 습관, 비인가된 행위 감시, 접근 제어 강화

  - **데이터 손실과 누출**
    - 소비자에게 가장 치명적인 보안 위험
    - 대응 방법 : API 접근 제어 강화, 데이터 암호화/무결성 제공, 설계 시 데이터 보호 분석, 안전한 키 관리

  - **계정이나 서비스 탈취**
    - 계정 및 비밀번호 유출 시 시스템은 무방비 상태가 됨
    - 대응 방법 : 사용자와 서비스 간 계정 정보 공유 금지, 다중 채널 인증 사용, 공격 탐지 이후 사후 감시

  - **알려지지 않은 위험 프로파일**
    - 사용자들이 보안 정책 절차를 따지지 않은 채 클라우드 제공자에게 의존
    - 대응 방법 : 로그와 데이터 공개, 기반 시설 공개, 정보 감시와 경계

<br>
<br>
<br>
<br>
<details>
<summary>주의사항</summary>
<div markdown="1">

이 포스팅은 강원대학교 이헌길 교수님의 컴퓨터시스템보안 수업을 들으며 내용을 정리 한 것입니다.  
수업 내용에 대한 저작권은 교수님께 있으니,  
다른 곳으로의 무분별한 내용 복사를 자제해 주세요.

</div>
</details>

[def]: https://i.imgur.com/27tFoIo.png
[def2]: https://i.imgur.com/TlR1SKa.png
[def3]: https://i.imgur.com/mFWJD1t.png
[def4]: https://i.imgur.com/yHODUGc.png
[def5]: https://i.imgur.com/fu0kJE6.png
[def6]: https://i.imgur.com/g7RkJeW.png
[def7]: https://i.imgur.com/hsEAaeu.png
[def8]: https://i.imgur.com/KdzBreG.png