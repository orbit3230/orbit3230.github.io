---
layout: post
title: "[컴퓨터시스템보안] 6주차 - 악성 소프트웨어"
excerpt: "악성 소프트웨어의 종류, 공격 킷, 공격 소스, 지능형 지속 위협 (APT), 바이러스, 웜, 모바일 코드, Drive-By-Download, 사회 공학(Social Engineering), Payload, 악성 소프트웨어 대비책"

tags:
  - [컴퓨터시스템보안]

toc: true

date: 2025-04-10
last_modified_at: 2025-04-17
---
## 악성 소프트웨어 (Malicious Software)  
- [SOUP13]은 악성 소프트웨어를 다음과 같이 정의했다.
  - "피해자의 데이터, 애플리케이션 또는 운영체제의 **기밀성**, **무결성**, 혹은 **가용성**을 손상시키거나  
  또는 단순히 피해자를 괴롭히거나 방해할 의도로 은밀하게 시스템에 **삽입된 프로그램**  

  <br>

### 1. 악성 소프트웨어의 종류
- **악성 S/W 관련 용어**  

|용어|설명|
|:---:|:---:|
|Advanced persistent threat (APT)|지속적이고 정교한 공격|
|Adware|광고 팝업|
|Attack kit|악성 S/W 자동 생성 해커 도구 모음|
|Auto-rooter|원격 침투 도구|
|Backdoor (trapdoor)|정상 보안 절차를 건너뛰는 기법|
|Downloaders|감염된 시스템에 침입한 악성 S/W에 포함되어, 다른 악성 S/W를 다운로드하는 프로그램|  
|Drive-by-Download|감염된 웹사이트 방문 시 심어져 있던 악성코드로 클라이언트 시스템 공격|
|Exploit|취약점을 이용한 공격|
|Flooders (Dos client)|DoS 공격을 위해 대량을 데이터를 발생|
|Keyloggers|키보드 입력을 기록/수집|
|Logic bomb|잠복하다가 조건이 만족되면 불법적인 행동을 수행|
|Macro virus|문서에 포함된 매크로/스크립트에 삽입되어 자동으로 실행|
|Mobile code|플랫폼 독립적인 코드|
|Rootkit|root escalation을 위한 도구|
|Spammer programs||스팸 메일 발송|
|Spyware|사용자의 동의 없이 시스템의 정보를 수집/전송|
|Trojan horse|정상적인 프로그램으로 위장한 악성 S/W|
|Virus|자기 복제 프로그램|
|Worm|독립적인 프로그램, 소프트웨어 취약점을 이용해 복사본 전파|
|Zombie, bot|감염된 시스템에서 다른 시스템을 공격|

<br>

- **악성 소프트웨어 분류**
  - 두 개의 큰 범주
    - (1) **번식**(propagation) 방법을 기준으로 분류
      - 기존 파일/스크립트를 감염시켜 다른 시스템으로 **전파**
      - 소프트웨어 취약점을 이용해 **증식**
      - 위장/우회를 통한 **사회공학적 공격**

    - (2) **악의적인 행동**(payload) 기준으로 분류
      - 시스템/데이터의 **파괴**
      - 감염을 통해 대리인을 만들어 **서비스 갈취**
      - 키 로깅을 통해 시스템 **정보 갈취**
      - 존재를 숨기기 위해 **탐지 무력회**

  - (3) **기타 분류**  

  <br>

### 2. 공격 킷 / 공격 소스
- **공격 킷**(Attack Kit)  
  - 공격자가 악성 S/W를 쉽게 만들 수 있도록 해주는 도구 모음
  - **crimeware**
  - 개발 및 보급이 용이하게 만들고, 다양한 변종을 만드는데 도움을 줌

- **공격 소스**(Attack Source)  
  - **개인 공격자 소스** -> **국가적 규모의 공격 소스**로 발전

<br>

### 3. 지능형 지속 위협 (APT)
- **다양한 침입 기술**과 **악성 S/W**를 사용하여 지정된 목표에 **지속적으로 공격**
- 주로 **국가 후원 조직**이나 **대규모 범죄 집단**에 의해 수행
- **공격 목표**를 미리 주의 깊게 **선정**,  
**장기간**에 걸쳐 **은밀하고 지속적인** 침입
- e.g., Aurora, RSA, APT1, Stuxnet

<br>

- APT 공격 특징
  - 지능형(Advanced)
  - 지속적(Persistent)
  - 위협(Threats)

- 목표 : 지적 재산, 보안 및 기반 시설 관련 데이터의 절도, 물리적인 파괴

- 사용 기술
  - 사회 공각 (Social Engineering)
  - Spear-phishing email
  - Drive-by downloads  

  <br>

### 4. 바이러스 (Virus)  
- 프로그램을 **감염** 시키는 소프트웨어 조각
  - 자신의 **복제 코드**를 executable 프로그램/콘텐츠에 **삽입**
  - 감염되지 않은 컴퓨터에 접속하면, 새로운 바이러스 복사본이 전달됨
  - 디스크/USB 저장 매체 또는 네트워크를 통해 전파

- Executable 프로그램에 바이러스가 침투되면, 인가 받은 어떤 작업이든 수행 가능
  - 감염된 호스트 프로그램과 함께 동시에 몰래 실행된다.  

- 바이러스는 OS/HW specific
  - OS/HW의 Weakness를 이용  

<br>

- **구성 요소**
  - **감염 메커니즘**(감염 코드) : 바이러스 확산/전파를 통해 복제/번식하는 수단. (**감염 벡터**)
  - **트리거**(작동 코드) : payload가 실행/전달되는 시점을 정의. (**논리 폭탄**)
  - **payload**(공격 코드) : 바이러스의 기능을 표현. 시스템 훼손/사용자의 주의 분산

  <br>

- **바이러스의 Life Cycle**
  - (1) 휴지(dormant) 단계 : 바이러스가 쉬고 있는 단계. 
  - (2) 트리거(triggering) 단계 : 바이러스가 의도한 기능을 수행하기 위해 활성화되는 단계.
  - (3) 전파or번식(propagation) 단계 : 바이러스가 전파되기 위해 복제본을 생성하는 단계.
  - (4) 실행(execution) 단계 : 바이러스가 의도한 기능을 수행하는 단계.  

  <br>

- 일반/압축 바이러스 로직 Example  
![virus_logic_example][def]  

<br>

- **일반/압축 바이러스 동작**  
![virus_logic_example2][def2]  
  - 일반 바이러스 : 바이러스 코드가 프로그램의 앞 부분에 삽입되어, 파일의 크기가 커짐.  
  -> 발견이 쉬움
  - 압축 바이러스 : 감염된 파일을 정상 파일의 크기와 같도록 **압축**.  
  -> 발견이 어려움  

<br>

- **바이러스 분류**
  - **부트 섹터 바이러스** : **마스터 부트 레코드** or **부트 레코드**를 감염. OS가 부팅될 때 확산됨
  - **파일 바이러스** : 실행 파일을 감염. 실행 시 감염된 파일이 메모리에 로드됨
  - **매크로 바이러스** : 응용프로그램에 의해 실행되는 **매크로**나 **스크립트**를 감염  
  - **다중 부분(multipartite) 바이러스** : **다양한 종류의 파일**들을 감염시킬 수 있는 바이러스
  - **암호화(encrypted) 바이러스** : 바이러스가 암호화 키를 만들어 나머지 부분을 **암호화**
  - **Stealth(은폐형) 바이러스** : 백신 프로그램으로부터 자신을 은폐
  - **Polymorphic(다형성) 바이러스** : 파일을 감염시킬 때마다 자신의 **형태**를 **변이**
  - **Metamorphic(변성/변이형) 바이러스** : 마찬가지로 감염마다 자신을 변화시키는데, **외관 뿐만 아니라 동작**까지 변화

  <br>

- **매크로/스크립팅 바이러스**
  - 1990년대 중반에 가장 널리 퍼져있던 바이러스 유형
    - Platform-Independent  
    - 실행 코드가 없는 **문서**를 감염 (MS Office 문서 내 매크로, Adobe PDF 문서 내 스크립트)
    - 문서는 일반적으로 **공유**되기 때문에 빠른 확산
    - 다만, 시스템을 감염시키는 데는 한계가 있음  

  - MS Office의 최신 버전들은 매크로 바이러스에 대한 보호가 철저
  - 많은 백신 프로그램이 개발되어 덜 위협적  

  <br>

### 5. 웜 (Worms)
- Worm 프로그램은 감염시킬 컴퓨터들을 **적극적으로 탐색하여 감염**, 감염된 컴퓨터에서 또 다른 감염으로 번식
- 클라이언트/서버 **프로그램의 취약점**을 이용하여 시스템 접근 권한 획득
- 네트워크 연결, 저장 매체의 공유를 통해 확산
- 전자 메일 Worm은 매크로/스크립트의 형태 or 인스턴트 메신저의 파일 전송으로 확산
- 자신을 번식시키는 행동 외에도, 특정 종류의 payload를 함께 감염  

<br>

- **웜 복제를 위한 원격 시스템 접근 방법**
  - 전자메일 / 인스턴트 메신저
  - 파일 공유
  - 원결 실행 기능
  - 원격 파일 접근 / 전송 기능
  - 원격 로그인 기능  

  <br>

- **웜의 공격 대상 탐색(Scanning)**
  - (1) **무작위**(random)  
  -> **대량의 인터넷 트래픽** 발생으로 DoS 형태의 공격 발생

  - (2) **적중 목록**(hit-list)  
  -> 잠재적인 **취약점을 가진 기기** 목록을 만들어 천천히 공격  
  
  - (3) **Topological**  
  -> 더 많은 스캔을 위해 **감염된 시스템에 저장된 정보** 이용

  - (4) **Local Subnet**  
  -> 방화벽 시스템 내 감염시킨 호스트를 이용해 로컬 네트워크에서 대상 탐색.  
  다른 호스트를 발견하는 데에는 **서브넷 주소 체계**를 이용  

<br>

- **Worm Propagation Model**  
![worm_propagation_model][def3]  

<br>

- **모리스 웜(Morris Worm)**  
  - 최초로 위력적이고 널리 알려진 인터넷 웜
  - **유닉스** 시스템의 취약점을 통해 번식되도록 설계.
    - (1) 로컬 시스템의 **패스워드 파일을 크래킹**, 로그인 시도. (여러 시스템에 같은 ID/PW 사용 가능성을 이용)
    - (2) Unix 시스템의 **finger** 프로토콜의 취약점을 이용하여 원격 시스템 사용자의 상태 확인
    - (3) 이메일 송수신 원격 프로세스의 디버그 옵션에 있는 **트랩도어(trapdoor)**를 활용

  - 공격 성공 시 시스템의 운영 체제가 제공하는 **명령 인터프리터**에 접근
    - 짧은 **부트스트랩 프로그램**을 통해 **Worm을 원격 시스템에 복제** 후 로그아웃.

    <br>

- **최신 웜 제작 기술**
  - **Multiplatform** : 다양한 플랫폼에 대해 공격, 문서 매크로/스크립트 언어를 공격
  - **Multi-exploit** : 여러 취약점으로 시스템 감염
  - **Ultrafast spreading** : 짧은 시간에 최대한 많은 시스템 감염
  - **Polymorphic(다형성)** :  형태가 다른 복제본으로 분석 회피
  - **Metamorphic(변성)** : 형태 뿐만 아니라 행동 패턴도 변화
  - **Transport vehicles** : 웜의 빠른 확산을 이용해 악성 payload 번식
  - **Zero-day explot** : 빠른 확산을 위해 잘 알려지지 않은 취약점 이용  

  <br>

- 휴대폰 웜 : 스마트 폰을 공격 대상으로 한 웜. 휴대폰을 완전히 못쓰게 한다. 주소록에 있는 사람들에게 MMS 형태로 전파

### 6. 모바일 코드 (Mobile Code)  
- 코드를 수정하지 않고 플랫폼을 옮겨다니며 적절한 시기에 스스로 실행되는 **스크립트**/**매크로** 형태의 프로그램

- 원격 시스템 -> 로컬 시스템으로 전송, 명시적인 조작 없이 실행

- 다른 악성 코드를 **전송하기 위한 메커니즘** 역할

- 때때로는 스스로가 **직접 로컬 사용자 시스템 공격**

- Java Applets, ActiveX, JavaScript, VBScript 등이 자주 사용되는 도구  

<br>

### 7. Drive-By-Download
- **웹 브라우저의 취약점**을 이용, **공격자가 컨트롤하는 웹 페이지**를 방문할 때 **사용자 시스템에 다운로드** 하여 설치  

- 적극적인 번식 보다는, 수동적인 번식 방법 (사이트 방문을 기다림)  

<br>

- **Clickjacking** : 감염된 사용자의 클릭을 가로채기 위하해, **투명한 레이어**를 씌워 클릭을 유도하는 공격 기법.  
(유사한 기술로서, **keystroke 가로채기**)  

<br>

### 7. 사회 공학(Social Engineering)
- **신뢰할 수 있는 사람/시스템 인 것처럼 가장**하여 **스스로 공격 당하도록 유도**하는 공격 기법  
  - 스팸 이메일 (Phishing)
  - 트로이 목마
  - 휴대전화 트로이 목마  

  <br>

### 8. Payload
- **시스템 파괴**
  - (1) 데이터 파괴 : 특정 날짜(트리거)가 되면 파괴 or 암호화
    - 체르노빌(Chernobyl) 바이러스, 클레즈(Klez), **랜섬웨어**(Ransomware)  

  - (2) 실 세계(real-world) 파괴 : 시스템에 물리적 손상
    - 체르노빌(Chernobyl) 바이러스, 스턱스넷(Stuxnet) 웜

  - (3) 논리 폭탄(Logic bomb) : 특정 조건이 만족되면 폭발하는 코드  

<br>

- **공격 에이전트: bot** : 감염된 컴퓨터를 다른 컴퓨터 공격에 사용  
  - **Botnets** : bot들의 집합
  - 사용 Example
    - **DDoS**, 스팸 메일, 스니핑 트래픽, 키로깅, 악성 코드 번식, 광고, ...  

- **원격 제어 기능** : **Bot**을 **Worm**과 구별하는 기능
  - 웜은 스스로 자기 자신을 전파
  - Bot은 적어도 초기에 중앙 컨트롤 서버에 의존
    - 주로 **IRC** 서버를 통해 구현.
    - 모든 bot들이 IRC 서버에 접속해 명령을 기다림.
    - 최근에는 HTTP와 같은 프로토콜을 통한 채널 사용
    - peer-to-peer 분산 제어 메커니즘도 사용됨

  <br>

- **정보 도용: Keyloggers & Spyware**
  - Keylogger : keystroke 데이터 수집
  - Spyware : 시스템의 행동/정보 수집

  <br>

- **정보 도용: Phising**
  - **사회 공학 기법**을 이용
    - 로그인 페이지를 흉내내는 가짜 URL
    - 서비스 중지를 빌미로 계정 인증을 요구
    - 공격자는 캡쳐한 개인 정보로 계정을 도용

  - **스피어 피싱**(Spear Phishing)
    - 공격자가 미리 특정 대상에 대한 정보를 수집
    - 수신자에 대해 **미리 수집한 특정 정보를 언급**하여 신뢰를 유도  

    <br>

- **은신: Backdoor**
  - **트랩도어(Trapdoor)**
  - 정상적인 보안 절차를 건너뛰는 기법
  - **Maintenance Hook** : 프로그래머가 디버깅/테스트를 목적으로 하는 백도어

<br>

- **은신: Rootkit**
  - 설치 흔적을 **최대한 숨기면서**, **관리자 권한**으로 **비밀 통로를 지속적으로 유지**시켜주는 일련의 프로그램 집합
  - 시스템을 **모니터링하는 메커니즘을 조작**하여 존재를 은폐
  - 공격자에게 **root 권한**을 부여  
  - 분류
    - Persistent rootkit : 부팅 시 자동으로 
    - Memory based rootkit : 메인 메모리에서만 존재, 재부팅 시 사라짐
    - User mode rootkit : API call을 가로채어 System call을 조작
    - Kernel mode rootkit : 커널 모드에서의 native API call을 가로채어 System call을 조작
    - Virtual machine based rootkit : 가상 머신을 설치하여 이 위에서 운영체제 실행
    - External mode rootkit : BIOS나 시스템 관리 모드 같은 외부에서 하드웨어에 접근  

    <br>

- **System Call 조작 기술**
  - User mode에서 실행되는 프로그램은 **System call**을 통해 Kernel과 상호작용.  
  -> 따라서, 은닉을 위한 rootkit의 주요 **Target**은 **System call**


  - 세 가지 System call 조작 기술  
  ![system_call_tech](TODO)  
    - (1) **System call table** 조작 : System call 주소를 변경
    - (2) **System call target** 조작 : 테이블은 그대로 두고, System call을 처리하는 Routine을 변경
    - (3) **System call table 바꿔치기** : 공격자가 만든 System call table의 주소로 바꿔치기  

    <br>

### 9. 악성 소프트웨어 대비책
- 악성 S/W에 대한 가장 Ideal Solution은 **에방(Prevention)**
  - 정책(Policy)
  - 사용자 인식(Awareness) 및 교육 : 사회 공학 공격 대비
  - 취약성 완화(Vulnerability Mitigation) : 시스템을 최신 상태로 유지
  - 위협 완화(Threat Mitigation) : 적절한 접근 제어로 감염 위협과 손상을 감소

- 예방이 실패할 경우, 위협을 최소화하기 위한 기술
  - **감지(Detection)** : 감염이 되었는 지, 악성 코드가 어디에 있는 지 탐지
  - **식별(Identification)** : 악성 코드의 종류를 파악
  - **제거(Removal)** : 바이러스의 모든 흔적을 제거  

  <br>

- 안티바이러스 소프트웨어의 세대 구분
  - 1st Gen - **Simple Scanners** : 악성코드의 이미 알려진 **시그니처**가 필요
  - 2nd Gen - **Heuristic Scanners** : 악성코드 가능성이 있는 인스턴스에 **Heuristic 분석**을 적용
  - 3rd Gen - **Activity Traps** : 감염된 프로그램의 내부 구조보다는 **행동 패턴**에 초점  
  - 4th Gen - **Full-featured Protection** : 1~3세대의 **Scanning** & **Activity Trap**을 결합하고 **접근 제어**기능을 모두 포함

  <br>

- **일반적 복호 (Generic Decryption, GD)**  
  - **빠른 스캐닝 속도**를 유지하면서도 **복잡한 다형성 바이러스**를 탐지할 수 있는 방법
  - 실행 파일들은 **GD 스캐너**를 통해 실행 됨
    - **CPU emulator**
    - **Virus signature scanner**
    - **Emulation control module**
    - 시뮬레이션이 시작되면 코드의 명령어가 하나씩 **해석**되고, 해독 루틴을 통해 악성 코드가 해석됨

  - GD 스캐너를 제작할 때 어려운 설계 이슈 : 각 **해석**을 얼마나 오래 수행하느냐
    - 시스템 성능 저하로 불편 초래 가능

    <br>

- **호스트 기반 행동-차단 소프트웨어**
  - 호스트 컴퓨터의 **OS와 통합**하여 어떤 프로그램이 의심되는 지 실시간으로 감시.
    - 시스템에 영향을 미치기 전에 미리 차단
    - 실시간으로 차단한다는 점에 있어 이점을 가짐
    - 그러나 시스템에서 먼저 실행해 봐야 하기 때문에, 먼저 영향을 미칠 수도 있음

    <br>

- **주변 장치 스캔 방법(Perimeter Scanning Approaches)**
  - **Ingress 모니터링** : 네트워크에 들어오는 트래픽을 모니터링
  - **Egress 모니터링** : 네트워크에서 나가는 트래픽을 모니터링
  - 단, 내용을 **스캔**하는 것에 제한, 행동을 감시하지는 못함

  <br>

- **웜 대응책(Worm Countermeasures)**  
  - **웜**이 컴퓨터에 상주하면, **안티-바이러스 소프트웨어가 탐지** 및 제거 가능.
  - **주변 네트워크 활동/사용량**을 모니터링하여 급격히 증가하는 지 확인
  - 여섯 가지 웜 방어 기법
    - Signature-based worm scan filtering
    - Filter-based worm containment
    - Payload-classification-based worm containment
    - Threshold random walk (TRW) scan detection
    - Rate limiting
    - Rate halting

<br>
<br>
<br>
<br>
<details>
<summary>주의사항</summary>
<div markdown="1">

이 포스팅은 강원대학교 이헌길 교수님의 컴퓨터시스템보안 수업을 들으며 내용을 정리 한 것입니다.  
수업 내용에 대한 저작권은 교수님께 있으니,  
다른 곳으로의 무분별한 내용 복사를 자제해 주세요.

</div>
</details>

[def]: https://i.imgur.com/NFQ3z0X.png
[def2]: https://i.imgur.com/OIZPFMk.png
[def3]: https://i.imgur.com/qnWHeKY.png