---
layout: post
title: "[컴퓨터네트워크] 12주차 - LANs"
excerpt: "Addressing, Address Resolution Protocol (ARP), Ethernet, Switches, VLANs"

tags:
  - [컴퓨터네트워크]

toc: true

date: 2025-11-20
last_modified_at: 2025-11-24
---
## LANs
### 1. Addressing, Address Resolution Protocol (ARP)  
- MAC address
  - 32-bit IP address (128-bit address in IPv6)
    - 각 인터페이스에 할당된 네트워크 계층 주소
    - Layer 3 forwarding에 사용됨
    - e.g., `143.70.234.100`
  
  - 48-bit MAC address (a.k.a. LAN or physical or Ethernet address)
    - 한 인터페이스에서 다른 인터페이스에 physically 연결되어, 프레임을 가져오기 위해 "locally" 사용되는 주소
    - NIC ROM에 박혀져서 나온다. (종종 software settable)
    - e.g., `1A-2F-BB-76-09-AD`  

<br>

- MAC address  
![mac_address][def]  
  - LAN의 각 인터페이스는
    - Unique 48-bit MAC address를 가짐
    - locally unique 32-bit IP address를 가짐

  - MAC address는 IEEE에 의해 관리되고 할당됨
  - Manufacturer는 MAC 주소 공간의 일부를 구매한다.
  - MAC address는 flat 하다.
    - Portability에 유리
    - 한 LAN에서 다른 LAN으로 이동 가능
    - 이에 반해, IP address는 portable하지 않다. 노드가 속한 IP subnet에 종속적이다.  

<br>

- Why do we need MAC address ?
  - 이론적으로, 네트워크는 IP address만으로도 동작할 수 있다.  
  - 하지만 실제로는...
    - 우리는 각 노드에 unique한 IP 주소를 제공하는 접근법을 가지고 있지 않다.
      - 누군가 수동적으로 자신의 기기에 IP 주소를 할당할 수도 있다.
      - 이렇게 되면 두 명 이상의 사람이 동시에 메시지를 받게 될 수 있다.
    - 기존 아키텍쳐때문에, MAC이 필요하다.
      - 만약 MAC 주소가 사용되지 않는다면, L2 계층은 수신한 어떠한 data frame이든 network layer로 곧바로 흘려보낼 것이다.  

    <br>

- Address Resolution Protocol (ARP)  
  - Question - 우리는 일반적으로 목적지 IP 주소와 함께 메시지를 보낸다. (DNS가 주는 IP 주소)  
  그러면, MAC 주소는 어떻게 메시지에 포함되고 메시지 전달에 사용되는가?  
    - Answer - IP 주소와 MAC 주소 간의 Address translation  
  ![arp_example][def2]  
    - ARP Table
      - LAN의 각 IP 노드(호스트, 라우터)는 table을 가짐
      - 몇몇 LAN 노드에 대한 IP/MAC 주소 매핑  
      `<IP address, MAC address, TTL>`  
      - TTL(Time-To-Live) 타이머가 지난 주소 매핑은 버려짐 (일반적으로 20분 정도)

- ARP protocol in action
  - e.g., `A`는 `B`에게 datagram을 보내길 원함  
    - `B`의 MAC 주소가 `A`의 ARP table에 없어서, `A`가 ARP 프로토콜을 사용하여 `B`의 MAC 주소를 찾으려 하는 상황  
  ![arp_process_1][def3]  
  ![arp_process_2][def4]  
  ![arp_process_3][def5]  

  - Routing to another subnet
    - e.g., `A`는 `B`에게 datagram을 보내길 원함. 이 때, `R`이라는 라우터가 `A`와 `B` 사이에 있음  
      - IP & MAC 계층에서의 addressing에 초점
      - 가정하길,
        - `A`는 `B`의 IP 주소를 알고 있음
        - `A`는 first hot 라우터 `R`의 IP 주소를 알고 있음 (how?)  
        - 따라서 `A`는 `R`의 MAC 주소도 알 수 있음 (how?)  
      ![arp_routing_process_1][def6]  
    
    - `A`는 source IP = `A`, destination IP = `B`인 datagram을 생성함  
    - `A`는 `A`-to-`B` datagram을 포함한 link-layer frame을 생성함
      - `R`의 MAC address가 frame의 destination MAC address가 됨  
    ![arp_routing_process_2][def7]  

    - frame이 `A`에서 `R`로 전송됨
    - frame이 `R`에 도달하면, datagram은 폐기되고 IP 계층으로 전달됨  
    ![arp_routing_process_3][def8]  

    - `R`은 outgoing 인터페이스를 결정하고, source IP = `A`, destination IP = `B`인 datagram를 link layer로 전달  
    ![arp_routing_process_4][def9]  

    - `R`은 `A`-to-`B` datagram을 포함한 link-layer frame을 생성함  
    - frame의 destination MAC address는 `B`의 MAC address가 될 것임  
    ![arp_routing_process_5][def10]  

    - `B`가 frame을 수신하면, `B`를 목적지로 한 IP datagram을 추출함
    - `B`는 IP 프로토콜 스택을 따라 datagram을 올려보냄  
    ![arp_routing_process_6][def11]  

<br>

### 2. Ethernet
- Dominant wired LAN technology
  - 처음으로 널리 사용된 LAN 테크놀로지
  - 간단하고, 저렴하다.
  - Speed race를 계속 중 (10Mbps -> 400Gbps...)
  - Single chip, Multiple speeds (e.g., Broadcom BCM 5761)

<br>

- Physical Topology of Ethernet  
  - Bus  
  ![ethernet_bus_topology][def12]
    - 90년대 중반까지 popular
    - 모든 노드가 같은 collision domain에 속함 (서로 충돌 가능)

  - Switched  
  ![ethernet_switched_topology][def13]  
    - 오늘날 만연히 사용됨
    - 중앙에 link-layer(L2) 스위치를 활성화
    - 각 "spoke(연결된 노드)"는 별도의 Ethernet 프로토콜을 실행 (노드들은 서로 충돌하지 않음)  

<br>

- Ethernet frame structure
  - IP datagram을 캡슐화하는 인터페이스를 전송  
  ![ethernet_frame_structure][def14]  

<br>

- Ethernet: Unreliable, Connectionless
  - Connectionless : 송신 & 수신 NIC 간 handshake 없음
  - Unreliable : 수신 NIC는 송신 NIC에 ACKs나 NAKs를 보내지 않음
    - 드랍된 프레임의 데이터는 오직 최초 송신자가 상위 계층에서 RDT(e.g., TCP)를 사용할 때만 복구됨
    - 그렂히않으면, 드랍된 데이터는 소실됨
  - Ethernet의 MAC 프로토콜 : unspotted CSMA/CD with binary backoff

<br>

- IEEE 802.3 Ethernet standards: link & physical layers  
![ieee_802_3_standards][def15]  
  - 서로다른 Ethernet 표준이 많이 존재
    - MAC 프로토콜과 frame 포맷은 동일
    - 서로 다른 속도 : 2Mbps, 10Mbps, 100Mbps, 1Gbps, 10Gbps, 40Gbps, ...
    - 서로 다른 physical layer media : fiber, cable, ...

<br>

### 3. Switches
- Ethernet 스위치
  - active role을 수행하는 link-layer 디바이스
  - Ethernet frames를 저장하고, 포워딩
  - 들어오는 프레임의 MAC address를 확인하고, 하나 이상의 outgoing 링크로 selectively 포워딩
  - 프레임이 세그먼트로 포워딩 될 때, CSMA/CD가 세그먼트에 접근하는데 사용됨
  - **Transparent** : 호스트는 스위치의 존재를 모름
  - **Plug-and-Play**, **self-learning** : 스위치는 특별한 설정 없이도 동작함  

- 여기서 Store-and-forward vs. cut-through
  - Store-and-forward  
  ![store_and_forward_switch][def16]  
    - 포워딩 결정이 이루어지려면, 전체 프레임이 수신되어야 함
  - Cut-through  
  ![cut_through_switch][def17]  
    - 프레임의 Destination MAC address를 얻으면 가능한 빨리 포워딩 결정이 이루어짐  

<br>

### 4. VLANs  

<br>
<br>
<br>
<br>
<details>
<summary>주의사항</summary>
<div markdown="1">

이 포스팅은 강원대학교 김도형 교수님의 컴퓨터네트워크 수업을 들으며 내용을 정리 한 것입니다.  
수업 내용에 대한 저작권은 교수님께 있으니,  
다른 곳으로의 무분별한 내용 복사를 자제해 주세요.

</div>
</details>

[def]: https://i.imgur.com/OEEipbR.png
[def2]: https://i.imgur.com/foAee2Y.png
[def3]: https://i.imgur.com/8FkHy9C.png
[def4]: https://i.imgur.com/8AlOrx4.png
[def5]: https://i.imgur.com/iqjxSrt.png
[def6]: https://i.imgur.com/yEnsY3p.png
[def7]: https://i.imgur.com/hVHVzt8.png
[def8]: https://i.imgur.com/qmdy2x9.png
[def9]: https://i.imgur.com/G1fWLqa.png
[def10]: https://i.imgur.com/rqlhglY.png
[def11]: https://i.imgur.com/v6tm4qZ.png
[def12]: https://i.imgur.com/gsNz6dQ.png
[def13]: https://i.imgur.com/VwggpMo.png
[def14]: https://i.imgur.com/iDdlEL3.png
[def15]: https://i.imgur.com/cDRpZiu.png
[def16]: https://i.imgur.com/T80sFcp.png
[def17]: https://i.imgur.com/ATXijNQ.png